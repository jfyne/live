"use strict";(()=>{var v=class{static hook(t){return t.getAttribute===void 0?null:t.getAttribute("live-hook")}};var O="live:mounted",G="live:beforeupdate",W="live:updated",z="live:beforedestroy",B="live:destroyed",_="live:disconnected",j="live:reconnected",I="live-connected",R="live-disconnected",J="live-error",o=class i{static{this.sequence=1}constructor(t,e,s){this.typ=t,this.data=e,s!==void 0?this.id=s:this.id=0}static GetID(){return this.sequence++}serialize(){return JSON.stringify({t:this.typ,i:this.id,d:this.data})}static fromMessage(t){let e=JSON.parse(t);return new i(e.t,e.d,e.i)}},a=class{constructor(){}static init(t,e){this.hooks=t,this.dom=e,this.eventHandlers={}}static handleEvent(t){t.typ in this.eventHandlers&&this.eventHandlers[t.typ].map(e=>{e(t.data)})}static mounted(t){let e=new CustomEvent(O,{}),s=this.getElementHooks(t);s!==null&&this.callHook(e,t,s.mounted)}static beforeUpdate(t,e){let s=new CustomEvent(G,{}),n=this.getElementHooks(t);n!==null&&this.callHook(s,t,n.beforeUpdate),this.dom!==void 0&&this.dom.onBeforeElUpdated!==void 0&&this.dom.onBeforeElUpdated(t,e)}static updated(t){let e=new CustomEvent(W,{}),s=this.getElementHooks(t);s!==null&&this.callHook(e,t,s.updated)}static beforeDestroy(t){let e=new CustomEvent(z,{}),s=this.getElementHooks(t);s!==null&&this.callHook(e,t,s.beforeDestroy)}static destroyed(t){let e=new CustomEvent(B,{}),s=this.getElementHooks(t);s!==null&&this.callHook(e,t,s.destroyed)}static disconnected(){let t=new CustomEvent(_,{});document.querySelectorAll("[live-hook]").forEach(e=>{let s=this.getElementHooks(e);s!==null&&this.callHook(t,e,s.disconnected)}),document.body.classList.add(R),document.body.classList.remove(I)}static reconnected(){let t=new CustomEvent(j,{});document.querySelectorAll("[live-hook]").forEach(e=>{let s=this.getElementHooks(e);s!==null&&this.callHook(t,e,s.reconnected)}),document.body.classList.remove(R),document.body.classList.add(I)}static error(){document.body.classList.add(J)}static getElementHooks(t){let e=v.hook(t);return e===null?e:this.hooks[e]}static callHook(t,e,s){if(s===void 0)return;let n=c=>{d.send(c)},r=(c,m)=>{c in this.eventHandlers||(this.eventHandlers[c]=[]),this.eventHandlers[c].push(m)};s.bind({el:e,pushEvent:n,handleEvent:r})(),e.dispatchEvent(t)}};var l=class{static{this.upKey="uploads"}static{this.formState={}}static dehydrate(){document.querySelectorAll("form").forEach(e=>{if(e.id===""){console.error("form does not have an ID. DOM updates may be affected",e);return}this.formState[e.id]=[],new FormData(e).forEach((s,n)=>{let r={name:n,value:s,focus:e.querySelector(`[name="${n}"]`)==document.activeElement};this.formState[e.id].push(r)})})}static hydrate(){Object.keys(this.formState).map(t=>{let e=document.querySelector(`#${t}`);if(e===null){delete this.formState[t];return}this.formState[t].map(n=>{let r=e.querySelector(`[name="${n.name}"]`);if(r!==null)switch(r.type){case"file":break;case"checkbox":n.value==="on"&&(r.checked=!0);break;default:r.value=n.value,n.focus===!0&&r.focus();break}})})}static serialize(t){let e={};return new FormData(t).forEach((n,r)=>{switch(!0){case n instanceof File:let c=n,m={name:c.name,type:c.type,size:c.size,lastModified:c.lastModified};Reflect.has(e,this.upKey)||(e[this.upKey]={}),Reflect.has(e[this.upKey],r)||(e[this.upKey][r]=[]),e[this.upKey][r].push(m);break;default:if(!Reflect.has(e,r)){e[r]=n;return}Array.isArray(e[r])||(e[r]=[e[r]]),e[r].push(n)}}),e}static hasFiles(t){let e=new FormData(t),s=!1;return e.forEach(n=>{n instanceof File&&(s=!0)}),s}};var f=class i{static handle(t){l.dehydrate(),t.data.map(i.applyPatch),l.hydrate()}static applyPatch(t){let e=document.querySelector(`*[${t.Anchor}]`);if(e===null)return;let s=i.html2Node(t.HTML);switch(t.Action){case 0:return;case 1:t.HTML===""?a.beforeDestroy(e):a.beforeUpdate(e,s),e.outerHTML=t.HTML,t.HTML===""?a.destroyed(e):a.updated(e);break;case 2:a.beforeUpdate(e,s),e.append(s),a.updated(e);break;case 3:a.beforeUpdate(e,s),e.prepend(s),a.updated(e);break}}static html2Node(t){let e=document.createElement("template");return t=t.trim(),e.innerHTML=t,e.content.firstChild===null?document.createTextNode(t):e.content.firstChild}};function w(i){let t={};if(new URLSearchParams(window.location.search).forEach((n,r)=>{t[r]=n}),i===void 0||!i.hasAttributes())return t;let s=i.attributes;for(let n=0;n<s.length;n++)s[n].name.startsWith("live-value-")&&(t[s[n].name.split("live-value-")[1]]=s[n].value);return t}function E(i){let t=new URL(i,location.origin),e=new URLSearchParams(t.search),s={};return e.forEach((n,r)=>{s[r]=n}),s}function b(i,t){if(window.history.pushState({},"",i),t===void 0)d.send(new o("params",{...E(i)}));else{let e=w(t);d.sendAndTrack(new o("params",{...e,...E(i)},o.GetID()),t)}}var u=class{constructor(t,e){this.event=t;this.attribute=e;this.limiter=new y}isWired(t){return t.hasAttribute(`${this.attribute}-wired`)?!0:(t.setAttribute(`${this.attribute}-wired`,""),!1)}attach(){document.querySelectorAll(`*[${this.attribute}]`).forEach(t=>{if(this.isWired(t)==!0)return;let e=w(t);t.addEventListener(this.event,s=>{this.limiter.hasDebounce(t)?this.limiter.debounce(t,s,this.handler(t,e)):this.handler(t,e)(s)}),t.addEventListener("ack",s=>{t.classList.remove(`${this.attribute}-loading`)})})}windowAttach(){document.querySelectorAll(`*[${this.attribute}]`).forEach(t=>{if(this.isWired(t)===!0)return;let e=w(t);window.addEventListener(this.event,this.handler(t,e)),window.addEventListener("ack",s=>{t.classList.remove(`${this.attribute}-loading`)})})}handler(t,e){return s=>{let n=t?.getAttribute(this.attribute);n!==null&&(t.classList.add(`${this.attribute}-loading`),d.sendAndTrack(new o(n,e,o.GetID()),t))}}},p=class extends u{handler(t,e){return s=>{let n=s,r=t?.getAttribute(this.attribute);if(r===null)return;let c=t.getAttribute("live-key");if(c!==null&&n.key!==c)return;t.classList.add(`${this.attribute}-loading`);let m={key:n.key,altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey};d.sendAndTrack(new o(r,{...e,...m},o.GetID()),t)}}},y=class{constructor(){this.debounceAttr="live-debounce"}hasDebounce(t){return t.hasAttribute(this.debounceAttr)}debounce(t,e,s){if(clearTimeout(this.debounceEvent),!this.hasDebounce(t)){s(e);return}let n=t.getAttribute(this.debounceAttr);if(n===null){s(e);return}if(n==="blur"){this.debounceEvent=s,t.addEventListener("blur",()=>{this.debounceEvent()});return}this.debounceEvent=setTimeout(()=>{s(e)},parseInt(n))}},L=class extends u{constructor(){super("click","live-click")}},g=class extends u{constructor(){super("contextmenu","live-contextmenu")}},H=class extends u{constructor(){super("mousedown","live-mousedown")}},x=class extends u{constructor(){super("mouseup","live-mouseup")}},M=class extends u{constructor(){super("focus","live-focus")}},T=class extends u{constructor(){super("blur","live-blur")}},A=class extends u{constructor(){super("focus","live-window-focus")}attach(){this.windowAttach()}},D=class extends u{constructor(){super("blur","live-window-blur")}attach(){this.windowAttach()}},S=class extends p{constructor(){super("keydown","live-keydown")}},$=class extends p{constructor(){super("keyup","live-keyup")}},P=class extends p{constructor(){super("keydown","live-window-keydown")}attach(){this.windowAttach()}},F=class extends p{constructor(){super("keyup","live-window-keyup")}attach(){this.windowAttach()}},U=class{constructor(){this.attribute="live-change";this.limiter=new y}isWired(t){return t.hasAttribute(`${this.attribute}-wired`)?!0:(t.setAttribute(`${this.attribute}-wired`,""),!1)}attach(){let t=[];document.querySelectorAll(`form[${this.attribute}]`).forEach(e=>{e.addEventListener("ack",s=>{e.classList.remove(`${this.attribute}-loading`)}),t.push(e),e.querySelectorAll("input,select,textarea").forEach(s=>{this.addEvent(e,s)})}),t.forEach(e=>{document.querySelectorAll(`[form=${e.getAttribute("id")}]`).forEach(s=>{this.addEvent(e,s)})})}addEvent(t,e){this.isWired(e)||e.addEventListener("input",s=>{this.limiter.hasDebounce(e)?this.limiter.debounce(e,s,()=>{this.handler(t)}):this.handler(t)})}handler(t){let e=t?.getAttribute(this.attribute);if(e===null)return;let s=l.serialize(t);t.classList.add(`${this.attribute}-loading`),d.sendAndTrack(new o(e,s,o.GetID()),t)}},K=class extends u{constructor(){super("submit","live-submit")}handler(t,e){return s=>{if(s.preventDefault&&s.preventDefault(),l.hasFiles(t)===!0){let r=new XMLHttpRequest;r.open("POST",""),r.addEventListener("load",()=>{this.sendEvent(t,e)}),r.send(new FormData(t))}else this.sendEvent(t,e);return!1}}sendEvent(t,e){let s=t?.getAttribute(this.attribute);if(s===null)return;var n={...e};let r=l.serialize(t);Object.keys(r).map(c=>{n[c]=r[c]}),t.classList.add(`${this.attribute}-loading`),d.sendAndTrack(new o(s,n,o.GetID()),t)}},q=class extends u{constructor(){super("","live-hook")}attach(){document.querySelectorAll(`[${this.attribute}]`).forEach(t=>{this.isWired(t)!=!0&&a.mounted(t)})}},C=class extends u{constructor(){super("click","live-patch")}handler(t,e){return s=>{s.preventDefault&&s.preventDefault();let n=t.getAttribute("href");if(n!==null)return b(n,t),!1}}},h=class{static init(){this.clicks=new L,this.contextmenu=new g,this.mousedown=new H,this.mouseup=new x,this.focus=new M,this.blur=new T,this.windowFocus=new A,this.windowBlur=new D,this.keydown=new S,this.keyup=new $,this.windowKeydown=new P,this.windowKeyup=new F,this.change=new U,this.submit=new K,this.hook=new q,this.patch=new C,this.handleBrowserNav()}static rewire(){this.clicks.attach(),this.contextmenu.attach(),this.mousedown.attach(),this.mouseup.attach(),this.focus.attach(),this.blur.attach(),this.windowFocus.attach(),this.windowBlur.attach(),this.keydown.attach(),this.keyup.attach(),this.windowKeyup.attach(),this.windowKeydown.attach(),this.change.attach(),this.submit.attach(),this.hook.attach(),this.patch.attach()}static handleBrowserNav(){window.onpopstate=function(t){d.send(new o("params",E(document.location.search),o.GetID()))}}};var N="_psid",d=class i{static{this.ready=!1}static{this.disconnectNotified=!1}constructor(){}static getID(){if(this.id)return this.id;let e=`; ${document.cookie}`.split(`; ${N}=`);if(e&&e.length===2){let s=e.pop();return s?s.split(";").shift():""}return""}static setCookie(){var t=new Date;t.setTime(t.getTime()+60*1e3),document.cookie=`${N}=${this.id}; expires=${t.toUTCString()}; path=/`}static dial(){this.trackedEvents={},this.id=this.getID(),this.setCookie(),console.debug("Socket.dial called",this.id),this.conn=new WebSocket(`${location.protocol==="https:"?"wss":"ws"}://${location.host}${location.pathname}${location.search}${location.hash}`),this.conn.addEventListener("close",t=>{this.ready=!1,console.warn(`WebSocket Disconnected code: ${t.code}, reason: ${t.reason}`),t.code!==1001&&(this.disconnectNotified===!1&&(a.disconnected(),this.disconnectNotified=!0),setTimeout(()=>{i.dial()},1e3))}),this.conn.addEventListener("open",t=>{a.reconnected(),this.disconnectNotified=!1,this.ready=!0}),this.conn.addEventListener("message",t=>{if(typeof t.data!="string"){console.error("unexpected message type",typeof t.data);return}let e=o.fromMessage(t.data);switch(e.typ){case"patch":f.handle(e),h.rewire();break;case"params":b(`${window.location.pathname}?${e.data}`);break;case"redirect":window.location.replace(e.data);break;case"ack":this.ack(e);break;case"err":a.error();default:a.handleEvent(e)}})}static sendAndTrack(t,e){if(this.ready===!1){console.warn("connection not ready for send of event",t);return}this.trackedEvents[t.id]={ev:t,el:e},this.conn.send(t.serialize())}static send(t){if(this.ready===!1){console.warn("connection not ready for send of event",t);return}this.conn.send(t.serialize())}static ack(t){t.id in this.trackedEvents&&(this.trackedEvents[t.id].el.dispatchEvent(new Event("ack")),delete this.trackedEvents[t.id])}};var k=class{constructor(t,e){this.hooks=t;this.dom=e}init(){document.querySelector("[live-rendered]")!==null&&(a.init(this.hooks,this.dom),d.dial(),h.init(),h.rewire())}send(t,e,s){let n=new o(t,e,s);d.send(n)}};document.addEventListener("DOMContentLoaded",i=>{window.Live!==void 0&&console.error("window.Live already defined");let t=window.Hooks||{};window.Live=new k(t),window.Live.init()});})();
//# sourceMappingURL=auto.js.map
